(function() {    tinymce.PluginManager.requireLangPack("wppropertyengine");    tinymce.create("tinymce.plugins.wppropertyenginePlugin", {init:function(b, e) {        var f = this;        b.addCommand("wppropertyengineSelector", function(a, c) {            var d = [];            d.push("tinymce=" + escape(tinymce.baseURL.replace(/^.+:\/\//, "//")));            b.windowManager.open({file:e + "/shortcode-" + c + ".html?" + d.join("&"),width:"450px",height:"490px",inline:1}, {plugin_url:e,shortcode:c,widget:c.replace(/propertyengine-/, "")})        });        b.onInit.add(function() {            if (b.settings.content_css !== false) {                dom =                    b.windowManager.createInstance("tinymce.dom.DOMUtils", document);                dom.loadCSS(e + "/css/content.css");                b.dom.loadCSS(e + "/css/content.css")            }        });        b.onNodeChange.add(function(a) {            f._selectMenu(a)        });        b.onBeforeGetContent.add(function(a) {            tinymce.each(a.getBody().getElementsByTagName("span"), function(c) {                if (a.dom.hasClass(c, "propertyengine"))c.innerHTML = c.innerHTML.replace(/<\/?[^>]*>/g, "")            })        });        b.onPostProcess.add(function(a, c) {            c.content = c.content.replace(/<span class="propertyengine [^>]+>([^<>]+)<\/span>/g, function(d, g) {                return g            })        });        b.onSetContent.add(function(a) {            a = a.getBody();            if (!/<span class="propertyengine propertyengine-[0-9a-z]+">/.test(a.innerHTML))a.innerHTML = a.innerHTML.replace(/(\[propertyengine-[a-z0-9]+[^\]]*\][^\[]+\[\/(propertyengine-[a-z0-9]+)\])/g, function(c, d, g) {                return'<span class="propertyengine ' + g + '">' + d + "</span>"            })        })    },createControl:function(b, e) {        var f = this,a = f._cache.menu,c,d = tinyMCE.activeEditor,g = tinymce.each;        if (b != "propertyengine-selector")return null;        c = e.createSplitButton(b, {cmd:"",scope:f,title:"wppropertyengine.desc"});        c.onRenderMenu.add(function(l, j) {            j.add({"class":"mceMenuItemTitle",title:"wppropertyengine.desc"}).setDisabled(1);            g(d.settings.propertyengine_enabled_widgets.split(","), function(i) {                var h = {icon:0},k = "wppropertyengine." + i.replace("-", "_");                h.onclick = function() {                    d.execCommand("wppropertyengineSelector", true, i)                };                h.title = k;                h = j.add(h);                a[i] = h            });            f._selectMenu(d)        });        return c    },shortcodes:{"propertyengine-livelist":"wppropertyengine.propertyengine_livelist","propertyengine-deals":"wppropertyengine.propertyengine_deals","propertyengine-mp3":"wppropertyengine.propertyengine_mp3",        "propertyengine-myfavorites":"wppropertyengine.propertyengine_myfavorites","propertyengine-product":"wppropertyengine.propertyengine_product","propertyengine-productcloud":"wppropertyengine.propertyengine_productcloud","propertyengine-slideshow":"wppropertyengine.propertyengine_slideshow","propertyengine-wishlist":"wppropertyengine.propertyengine_wishlist"},getInfo:function() {        return{longname:"PropertyEngine Widgets Shortcodes",author:"Oncle Tom",authorurl:"http://oncle-tom.net",infourl:"http://wordpress.org/extend/plugins/propertyengine-real-estate/",version:"1.6"}    },_cache:{menu:{}},_selectMenu:function(b) {        var e =            b.selection.getNode(),f = tinymce.each,a = this._cache.menu;        f(this.shortcodes, function(c, d) {            typeof a[d] == "undefined" || !a[d] || a[d].setSelected(b.dom.hasClass(e, d))        })    }});    tinymce.PluginManager.add("wppropertyengine", tinymce.plugins.wppropertyenginePlugin)})();